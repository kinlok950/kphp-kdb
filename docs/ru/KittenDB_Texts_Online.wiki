=== Поддержка списка друзей онлайн ===

=== Нотификация об онлайне пользователя ===

<code>set("online$id", "$friend1,$friend2,$friend3,...,$friendN")</code>
<br>
<code>set("online$id_$extra", "$friend1,$friend2,$friend3,...,$friendN")</code>

Эту функцию необходимо запустить, если пользователь $id совершил некоторое действие, которое говорит о том, что он сейчас находится в онлайне. В качестве параметра передаётся список друзей пользователя $id, полученный из [[KittenDB_Friends.wiki|KittenDB Friends]] с помощью операции <code>get("friends$id")</code>. Рекомендуется кэшировать время последнего запуска этой функции в memcache, и запускать её не чаще, чем раз в 5 минут.

Вторая форма передаёт дополнительный параметр $extra, обычно описывающий тип устройства, с которого зашёл пользователь $id. В первой форме этот параметр считается равным нулю.

Поддерживается также двоичный режим (как правило, используемый для внутренних взаимодействий между engine), в котором аргумент для set состоит из 4N+4 байт - 32-битных чисел в формате big-endian, первое из которых - количество элементов запроса N, не превосходящее 2^16-1.

=== Нотификация об оффлайне пользователя ===

<code>set("offline$id", "$friend1,$friend2,$friend3,...,$friendN")</code>

Эту функцию необходимо запустить, если пользователь $id выполнил logoff. В качестве параметра передаётся список друзей пользователя $id, полученный из [[KittenDB_Friends.wiki|KittenDB Friends]] с помощью операции <code>get("friends$id")</code>.

Поддерживается также двоичный режим аналогично предыдущей функции.

=== Получение списка друзей онлайн ===

<code>get("onlinefriends$id[#$mode]")</code>

Возвращает список друзей онлайн вида:
<br>
$cnt,$friend1,$friend2,...,$friendK (если $mode не задан или равен 0)
<br>
или
<br>
$cnt,$friend1,$time1,...,$friendK,$timeK (если $mode=1)
<br>
или
<br>
$cnt,$friend1,$extra1,...,$friendK,$extraK (если $mode=2)
<br>
или
<br>
$cnt,$friend1,$time1,$extra1,...,$friendK,$timeK,$extraK (если $mode=3)

Здесь <code>$cnt</code>, он же K -- количество друзей онлайн, $timeN -- время последнего обновления статуса онлайн для соответствующего друга, $extraN -- дополнительный параметр, переданный при установке статуса онлайн (обычно -- тип устройства). 
